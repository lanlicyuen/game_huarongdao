<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åå®¹é“å…³å¡éªŒè¯æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
        }
        .valid {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .invalid {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .summary {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
            font-weight: bold;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ” åå®¹é“å…³å¡éªŒè¯æµ‹è¯•</h1>
        <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•æ‰€æœ‰å…³å¡çš„æœ‰æ•ˆæ€§ï¼Œç¡®ä¿æ¯ä¸ªå…³å¡éƒ½å¯ä»¥æ­£å¸¸æ¸¸æˆã€‚</p>
        
        <button onclick="runValidation()">å¼€å§‹éªŒè¯æ‰€æœ‰å…³å¡</button>
        <button onclick="runDetailedValidation()">è¯¦ç»†éªŒè¯æŠ¥å‘Š</button>
        <button onclick="clearResults()">æ¸…é™¤ç»“æœ</button>
        
        <div id="results"></div>
    </div>

    <script src="script.js"></script>
    <script>
        let gameInstance = null;
        
        function initGame() {
            if (!gameInstance) {
                // åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„æ¸¸æˆå®¹å™¨
                const tempContainer = document.createElement('div');
                tempContainer.style.display = 'none';
                tempContainer.innerHTML = `
                    <div id="game-board"></div>
                    <div id="current-level">1</div>
                    <div id="move-count">0</div>
                    <div id="timer">00:00</div>
                `;
                document.body.appendChild(tempContainer);
                
                gameInstance = new HuaRongDao();
            }
            return gameInstance;
        }
        
        function runValidation() {
            const game = initGame();
            const results = game.validateAllLevels();
            displayResults(results);
        }
        
        function runDetailedValidation() {
            const game = initGame();
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<h3>è¯¦ç»†éªŒè¯æŠ¥å‘Š</h3>';
            
            console.log('å¼€å§‹è¯¦ç»†éªŒè¯...');
            
            for (let level = 1; level <= 10; level++) {
                const levelData = game.levels[level];
                const isValid = game.validateLevel(levelData);
                const emptyCells = game.getEmptyCellsCount(levelData);
                
                // åˆ›å»ºè¯¦ç»†çš„åˆ†ææŠ¥å‘Š
                const analysis = analyzeLevel(levelData, game.gridSize);
                
                const resultDiv = document.createElement('div');
                resultDiv.className = `test-result ${isValid ? 'valid' : 'invalid'}`;
                resultDiv.innerHTML = `
                    <strong>å…³å¡ ${level}:</strong> ${isValid ? 'âœ“ æœ‰æ•ˆ' : 'âœ— æ— æ•ˆ'}<br>
                    <strong>ç©ºä½æ•°é‡:</strong> ${emptyCells}<br>
                    <strong>æ£‹å­æ•°é‡:</strong> ${levelData.pieces.length}<br>
                    <strong>å¸ƒå±€åˆ†æ:</strong> ${analysis}
                `;
                
                resultsDiv.appendChild(resultDiv);
            }
            
            // æ·»åŠ æ€»ç»“
            const validCount = game.validateAllLevels().filter(r => r.valid).length;
            const summaryDiv = document.createElement('div');
            summaryDiv.className = 'summary';
            summaryDiv.innerHTML = `
                <h4>éªŒè¯æ€»ç»“</h4>
                <p>âœ… æœ‰æ•ˆå…³å¡: ${validCount}/10</p>
                <p>âŒ æ— æ•ˆå…³å¡: ${10 - validCount}/10</p>
                <p>é€šè¿‡ç‡: ${(validCount * 10).toFixed(1)}%</p>
            `;
            resultsDiv.appendChild(summaryDiv);
        }
        
        function analyzeLevel(levelData, gridSize) {
            const totalCells = gridSize.width * gridSize.height;
            let occupiedCells = 0;
            const pieceTypes = {};
            
            levelData.pieces.forEach(piece => {
                occupiedCells += piece.width * piece.height;
                pieceTypes[piece.type] = (pieceTypes[piece.type] || 0) + 1;
            });
            
            const emptyCells = totalCells - occupiedCells;
            const density = ((occupiedCells / totalCells) * 100).toFixed(1);
            
            return `å¯†åº¦${density}%, æ£‹å­ç±»å‹: ${JSON.stringify(pieceTypes)}`;
        }
        
        function displayResults(results) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<h3>å¿«é€ŸéªŒè¯ç»“æœ</h3>';
            
            results.forEach(result => {
                const resultDiv = document.createElement('div');
                resultDiv.className = `test-result ${result.valid ? 'valid' : 'invalid'}`;
                resultDiv.textContent = `å…³å¡ ${result.level}: ${result.valid ? 'âœ“ æœ‰æ•ˆ' : 'âœ— æ— æ•ˆ'} (ç©ºä½: ${result.emptyCells})`;
                resultsDiv.appendChild(resultDiv);
            });
            
            const validCount = results.filter(r => r.valid).length;
            const summaryDiv = document.createElement('div');
            summaryDiv.className = 'summary';
            summaryDiv.textContent = `éªŒè¯å®Œæˆ: ${validCount}/10 ä¸ªå…³å¡æœ‰æ•ˆ`;
            resultsDiv.appendChild(summaryDiv);
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡Œä¸€æ¬¡å¿«é€ŸéªŒè¯
        window.addEventListener('load', () => {
            setTimeout(runValidation, 1000);
        });
    </script>
</body>
</html>
